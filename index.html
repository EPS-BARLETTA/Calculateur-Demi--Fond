<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculateur Demi‚Äëfond ‚Äì VMA, % et Tours</title>
  <style>
    :root{
      --bg:#f6f8fb; --card:#ffffff; --ink:#0f172a; --muted:#64748b;
      --primary:#2563eb; --accent:#10b981; --warn:#f59e0b; --danger:#ef4444;
      --radius:14px; --shadow:0 10px 30px rgba(2,6,23,.08);
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    body{margin:0;background:var(--bg);color:var(--ink)}
    .wrap{max-width:1100px;margin:32px auto;padding:0 16px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:18px}
    h1{font-size:clamp(20px,3vw,28px);margin:0}
    .subtitle{color:var(--muted);font-size:14px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .card{grid-column:span 12;background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px}
    @media(min-width:900px){.card.half{grid-column:span 6}}
    .card h2{font-size:18px;margin:0 0 8px}
    .row{display:grid;grid-template-columns:160px 1fr 140px;gap:10px;align-items:center;margin:10px 0}
    .row label{color:var(--muted);font-size:14px}
    input[type="number"], input[type="text"], select{width:100%;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff}
    .help{font-size:12px;color:var(--muted)}
    .btns{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    button{border:0;border-radius:12px;padding:10px 14px;font-weight:600;cursor:pointer}
    .primary{background:var(--primary);color:#fff}
    .ghost{background:#eef2ff;color:#1e3a8a}
    .accent{background:var(--accent);color:#052e1a}
    .warn{background:#fff7ed;color:#9a3412}
    .danger{background:#fee2e2;color:#7f1d1d}
    .out{margin-top:12px;padding:12px;border-radius:12px;background:#f8fafc;border:1px solid #e2e8f0}
    .out b{display:inline-block;min-width:180px}
    .recap{margin-top:12px;padding:12px;border-radius:12px;background:#eef2ff;border:1px solid #c7d2fe}
    .kpi{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:10px}
    .kpi div{background:#f1f5f9;border:1px solid #e2e8f0;border-radius:12px;padding:10px;text-align:center}
    .kpi h3{margin:4px 0 0;font-size:18px}
    .kpi span{display:block;color:var(--muted);font-size:12px}
    table{width:100%;border-collapse:collapse}
    th,td{border:1px solid #e2e8f0;padding:8px;text-align:center}
    th{background:#f1f5f9}
    footer{margin:20px 0;color:var(--muted);font-size:12px;text-align:center}
    /* Page d'accueil centr√©e */
    #home{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;text-align:center}
    #home h1{font-size:clamp(28px,6vw,42px);margin-bottom:12px}
    #home button{font-size:20px;padding:16px 28px;background:var(--primary);color:#fff;border-radius:16px}
    /* Menu */
    #menu{display:none;min-height:100vh;align-items:center;justify-content:center}
    .menu-grid{display:grid;grid-template-columns:repeat(1,minmax(240px,340px));gap:20px;justify-content:center}
    @media(min-width:720px){.menu-grid{grid-template-columns:repeat(2,minmax(280px,380px));}}
    .menu-card{border:1px solid #e2e8f0;border-radius:16px;box-shadow:var(--shadow);padding:26px;cursor:pointer;color:#fff;text-align:center;font-weight:700;font-size:18px;transition:transform .12s ease, filter .12s ease}
    .menu-card:hover{transform:translateY(-2px);filter:saturate(1.08)}
    .menu-card h3{margin:0 0 6px}
    .mc-A{background:#2563eb}
    .mc-B{background:#10b981}
    .mc-S{background:#f59e0b}
    .mc-SP{background:#8b5cf6}
  </style>
</head>
<body>

  <!-- Page d'accueil -->
  <div id="home">
    <h1>Calculateur Demi‚Äëfond</h1>
    <p class="subtitle">Application EPS ‚Äì VMA, % et Tours</p>
    <button onclick="startApp()">üöÄ D√©marrer</button>
  </div>
  <footer>¬© 2025 ‚Ä¢ Calculateur Demi‚Äëfond ‚Äì √âquipe EPS Lyc√©e Vauban Luxembourg ‚Äì JB</footer>

  <!-- Menu des options -->
  <div id="menu" class="wrap" style="display:none">
    <header>
      <div>
        <h1>Calculateur Demi‚Äëfond</h1>
        <div class="subtitle">Choisis un mode de calcul</div>
      </div>
    </header>
    <div class="menu-grid">
      <div class="menu-card mc-A" onclick="goto('A')">
        <h3>√Ä partir de la VMA et du %</h3>
        <div class="subtitle">Temps au tour, distance, tours, passages cumul√©s</div>
      </div>
      <div class="menu-card mc-B" onclick="goto('B')">
        <h3>√Ä partir d‚Äôun temps ou d‚Äôune dur√©e</h3>
        <div class="subtitle">%VMA estim√©, tours, passages cumul√©s</div>
      </div>
      <div class="menu-card mc-S" onclick="goto('S')">
        <h3>üéØ Mode S√©ance (presets)</h3>
        <div class="subtitle">Tableau cibles + passages cumul√©s</div>
      </div>
      <div class="menu-card mc-SP" onclick="goto('SP')">
        <h3>üõ†Ô∏è S√©ance personnalis√©e</h3>
        <div class="subtitle">Cr√©e ta s√©ance + passages cumul√©s</div>
      </div>
    </div>
    <footer>¬© 2025 ‚Ä¢ Calculateur Demi‚Äëfond ‚Äì √âquipe EPS Lyc√©e Vauban Luxembourg ‚Äì JB</footer>
  </div>

  <!-- Application -->
  <div id="app" class="wrap" style="display:none">
    <header class="app-header">
      <div>
        <h1>Calculateur Demi‚Äëfond</h1>
        <div class="subtitle">Piste personnalis√©e (ex. 253 m) ‚Ä¢ Allure √† %VMA ‚Ä¢ Tours, temps au tour, distances</div>
      </div>
      <div class="btns">
        <button class="ghost" onclick="goMenu()">‚¨ÖÔ∏è Menu</button>
        <button class="ghost" onclick="goHome()">üè† Accueil</button>
      </div>
    </header>

    <div class="grid">

      <!-- Bloc A : √Ä partir de VMA & % -->
      <section class="card half" data-page="A" style="display:none">
        <h2>A. √Ä partir de la VMA et du %</h2>
        <div class="row">
          <label for="lap">Distance d‚Äôun tour (m)</label>
          <input id="lap" type="number" min="50" step="1" value="253" />
          <div class="help">ex. 253</div>
        </div>
        <div class="row">
          <label for="vma">VMA (km/h)</label>
          <input id="vma" type="number" min="6" max="25" step="0.1" value="12" />
          <div class="help">VMA mesur√©e (Luc L√©ger, VAMEVAL‚Ä¶)</div>
        </div>
        <div class="row">
          <label for="pct">Intensit√© (% VMA)</label>
          <input id="pct" type="number" min="50" max="110" step="1" value="80" />
          <div class="help">G√©n√©ralement 70‚Äì90 %</div>
        </div>
        <div class="row">
          <label for="dur">Dur√©e de l‚Äôeffort (min)</label>
          <input id="dur" type="number" min="1" step="1" value="15" />
          <div class="btns">
            <button class="ghost" onclick="setDur(12)">12 min</button>
            <button class="ghost" onclick="setDur(15)">15 min</button>
            <button class="ghost" onclick="setDur(20)">20 min</button>
          </div>
        </div>
        <div class="btns">
          <button class="primary" onclick="calcFromVMA()">Calculer</button>
          <button class="accent" onclick="buildPassages('A')">Passages cumul√©s</button>
          <button class="danger" onclick="resetA()">R√©initialiser</button>
          <button class="ghost" onclick="goMenu()">‚¨ÖÔ∏è Retour menu</button>
        </div>
        <div id="outA" class="out" hidden></div>
        <div id="passA" class="out" hidden></div>
        <div id="recapA" class="recap" hidden>
          <h3>R√©capitulatif</h3>
          <div class="kpi">
            <div><span>Allure (m/min)</span><h3 id="k1">‚Äî</h3></div>
            <div><span>Allure (km/h)</span><h3 id="k2">‚Äî</h3></div>
            <div><span>Temps au tour</span><h3 id="k3">‚Äî</h3></div>
            <div><span>Tours sur la dur√©e</span><h3 id="k4">‚Äî</h3></div>
          </div>
        </div>
      </section>

      <!-- Bloc B : √Ä partir d‚Äôun temps ou d‚Äôune dur√©e globale -->
      <section class="card half" data-page="B" style="display:none">
        <h2>B. √Ä partir d‚Äôun temps ou d‚Äôune dur√©e ‚Üí tours & %VMA</h2>
        <div class="row">
          <label for="lap2">Distance d‚Äôun tour (m)</label>
          <input id="lap2" type="number" min="50" step="1" value="253" />
          <div class="help">ex. 253</div>
        </div>
        <div class="row">
          <label for="vma2">VMA (km/h)</label>
          <input id="vma2" type="number" min="6" max="25" step="0.1" value="12" />
          <div class="help">Pour estimer le %VMA</div>
        </div>
        <div class="row">
          <label for="lapTime">Temps au tour (mm:ss)</label>
          <input id="lapTime" type="text" placeholder="01:40" />
          <div class="help">Option 1 : indique un temps au tour</div>
        </div>
        <div class="row">
          <label for="dur2">Dur√©e totale (min)</label>
          <input id="dur2" type="number" min="1" step="1" value="15" />
          <div class="help">Option 2 : indique une dur√©e pour obtenir le nombre de tours</div>
        </div>
        <div class="btns">
          <button class="primary" onclick="calcFromTime()">Calculer</button>
          <button class="accent" onclick="buildPassages('B')">Passages cumul√©s</button>
          <button class="danger" onclick="resetB()">R√©initialiser</button>
          <button class="ghost" onclick="goMenu()">‚¨ÖÔ∏è Retour menu</button>
        </div>
        <div id="outB" class="out" hidden></div>
        <div id="passB" class="out" hidden></div>
        <div id="recapB" class="recap" hidden>
          <h3>R√©capitulatif</h3>
          <div id="recapBContent">‚Äî</div>
        </div>
      </section>

      <!-- Bloc S : Mode S√©ance (presets) -->
      <section class="card" data-page="S" style="display:none">
        <h2>üéØ Mode S√©ance (presets)</h2>
        <div class="row" style="grid-template-columns:220px 1fr 340px">
          <label for="preset">Choisir une s√©ance type</label>
          <select id="preset">
            <option value="">‚Äî S√©lectionne ‚Äî</option>
            <option value="2x6-80-3">2 √ó 6' @80% (r√©cup 3')</option>
            <option value="3x6-85-3">3 √ó 6' @85% (r√©cup 3')</option>
            <option value="4x4-90-2">4 √ó 4' @90% (r√©cup 2')</option>
            <option value="12x1-80-0">12' continu @80%</option>
            <option value="15x1-80-0">15' projet @80%</option>
            <option value="20x1-80-0">20' projet @80%</option>
          </select>
          <div class="btns">
            <button class="primary" onclick="buildSession()">G√©n√©rer cibles</button>
            <button class="ghost" onclick="applyToInputs()">üîÅ Appliquer aux champs</button>
            <button class="accent" onclick="buildPassages('S')">Passages cumul√©s</button>
          </div>
        </div>
        <div id="outS" class="out" hidden></div>
        <div id="passS" class="out" hidden></div>
      </section>

      <!-- Bloc SP : S√©ance personnalis√©e -->
      <section class="card" data-page="SP" style="display:none">
        <h2>üõ†Ô∏è S√©ance personnalis√©e</h2>
        <div class="row" style="grid-template-columns:200px repeat(3,1fr)">
          <label for="repCount">R√©p√©titions √ó dur√©e (min)</label>
          <input id="repCount" type="number" min="1" step="1" value="3" />
          <input id="repMin" type="number" min="1" step="1" value="6" />
          <div class="help">ex. 3 √ó 6'</div>
        </div>
        <div class="row">
          <label for="pctP">Intensit√© (% VMA)</label>
          <input id="pctP" type="number" min="50" max="110" step="1" value="80" />
          <div class="help">g√©n√©ralement 70‚Äì90 %</div>
        </div>
        <div class="row">
          <label for="recP">R√©cup√©ration (min)</label>
          <input id="recP" type="number" min="0" step="0.5" value="3" />
          <div class="help">entre les r√©p√©titions</div>
        </div>
        <div class="btns">
          <button class="primary" onclick="buildCustom()">Calculer la s√©ance</button>
          <button class="accent" onclick="buildPassages('SP')">Passages cumul√©s</button>
          <button class="ghost" onclick="goMenu()">‚¨ÖÔ∏è Retour menu</button>
        </div>
        <div id="outSP" class="out" hidden></div>
        <div id="passSP" class="out" hidden></div>
      </section>

    </div>

    <footer>
      ¬© 2025 ‚Ä¢ Calculateur Demi‚Äëfond ‚Äì √âquipe EPS Lyc√©e Vauban Luxembourg ‚Äì JB
    </footer>
  </div>

<script>
  // Nav
  function startApp(){
    document.getElementById('home').style.display = 'none';
    document.getElementById('menu').style.display = 'block';
  }
  function goto(code){
    document.getElementById('menu').style.display = 'none';
    document.getElementById('app').style.display = 'block';
    document.querySelectorAll('[data-page]').forEach(el=>el.style.display='none');
    const map = {A:'[data-page="A"]',B:'[data-page="B"]',S:'[data-page="S"]',SP:'[data-page="SP"]'};
    const sel = map[code]||map['A'];
    const el = document.querySelector(sel);
    if(el){ el.style.display = 'block'; window.scrollTo({top:0,behavior:'smooth'}); }
  }
  function goMenu(){
    document.getElementById('app').style.display = 'none';
    document.getElementById('menu').style.display = 'block';
  }
  function goHome(){
    document.getElementById('app').style.display = 'none';
    document.getElementById('menu').style.display = 'none';
    document.getElementById('home').style.display = 'flex';
  }

  // Utils
  const toSeconds = (mmss) => {
    if(!mmss) return NaN;
    const parts = mmss.split(":").map(Number);
    if(parts.length === 1) return parts[0];
    if(parts.length === 2) return parts[0]*60 + parts[1];
    return NaN;
  };
  const toMMSS = (sec) => {
    if(!isFinite(sec) || sec<=0) return "‚Äî";
    const m = Math.floor(sec/60);
    const s = Math.round(sec%60);
    return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
  };
  const round = (x, d=2) => Number.isFinite(x) ? Number(x.toFixed(d)) : NaN;
  function setDur(val){ document.getElementById('dur').value = val; }

  // Bloc A ‚Äì VMA & %
  function calcFromVMA(){
    const lap = parseFloat(document.getElementById('lap').value);
    const vma = parseFloat(document.getElementById('vma').value);
    const pct = parseFloat(document.getElementById('pct').value);
    const dur = parseFloat(document.getElementById('dur').value);
    if(!lap || !vma || !pct || !dur){ alert('Compl√®te tous les champs.'); return; }

    const v_kmh = vma * (pct/100);
    const v_mps = v_kmh * 1000 / 3600; // m/s
    const v_mpm = v_kmh * 1000 / 60;   // m/min

    const lapTime_s = lap / v_mps;      // s
    const totalDist = v_mpm * dur;      // m
    const laps = totalDist / lap;       // nb

    const out = document.getElementById('outA');
    out.hidden = false;
    out.innerHTML = `
      <div><b>Vitesse √† ${pct}%VMA :</b> ${round(v_kmh,2)} km/h ‚Ä¢ ${round(v_mpm,1)} m/min</div>
      <div><b>Temps au tour (${lap} m) :</b> ${toMMSS(lapTime_s)} (‚âà ${round(lapTime_s,1)} s)</div>
      <div><b>En ${dur} min :</b> ${Math.round(totalDist)} m ‚Ä¢ ‚âà ${round(laps,2)} tours</div>
    `;

    document.getElementById('k1').textContent = `${round(v_mpm,1)} m/min`;
    document.getElementById('k2').textContent = `${round(v_kmh,2)} km/h`;
    document.getElementById('k3').textContent = toMMSS(lapTime_s);
    document.getElementById('k4').textContent = `${round(laps,2)} tours`;
    document.getElementById('recapA').hidden = false;
  }
  function resetA(){
    document.getElementById('lap').value = 253;
    document.getElementById('vma').value = 12;
    document.getElementById('pct').value = 80;
    document.getElementById('dur').value = 15;
    document.getElementById('outA').hidden = true;
    document.getElementById('recapA').hidden = true;
    document.getElementById('passA').hidden = true;
  }

  // Bloc B ‚Äì Temps ou dur√©e
  function calcFromTime(){
    const lap = parseFloat(document.getElementById('lap2').value);
    const vma = parseFloat(document.getElementById('vma2').value);
    const lapTimeTxt = document.getElementById('lapTime').value.trim();
    const dur = parseFloat(document.getElementById('dur2').value);
    if(!lap || !vma){ alert('Renseigne distance de tour et VMA.'); return; }

    let html = '';
    if(lapTimeTxt){
      const lapTime_s = toSeconds(lapTimeTxt);
      if(!isFinite(lapTime_s)){ alert('Temps au tour invalide. Format mm:ss'); return; }
      const v_mps = lap / lapTime_s;
      const v_kmh = v_mps * 3.6;
      const pct = (v_kmh / vma) * 100;
      html += `<div><b>Allure mesur√©e :</b> ${round(v_kmh,2)} km/h ‚Ä¢ ${round(v_mps*60,1)} m/min ‚Ä¢ ‚âà ${round(pct,1)}% VMA</div>`;
    }
    if(dur){
      const pctList = [70,80,90];
      html += `<div style="margin-top:6px"><b>Tours √† r√©aliser en ${dur} min :</b></div>`;
      html += '<ul style="margin:6px 0 0 18px">';
      pctList.forEach(p=>{
        const v_kmh = vma * (p/100);
        const v_mpm = v_kmh * 1000 / 60;
        const dist = v_mpm * dur;
        const laps = dist / lap;
        html += `<li>${p}% VMA ‚Üí ${Math.round(dist)} m ‚Ä¢ ‚âà ${round(laps,2)} tours</li>`;
      });
      html += '</ul>';
    }
    if(!html){ html = '<div>Aucun calcul : indique au moins un temps au tour ou une dur√©e.</div>'; }

    const out = document.getElementById('outB');
    out.hidden = false;
    out.innerHTML = html;
    document.getElementById('recapBContent').innerHTML = html;
    document.getElementById('recapB').hidden = false;
  }
  function resetB(){
    document.getElementById('lap2').value = 253;
    document.getElementById('vma2').value = 12;
    document.getElementById('lapTime').value = '';
    document.getElementById('dur2').value = 15;
    document.getElementById('outB').hidden = true;
    document.getElementById('recapB').hidden = true;
    document.getElementById('passB').hidden = true;
  }

  // Presets s√©ance
  function parsePreset(code){
    if(!code) return null;
    const [left, right] = code.split('-');
    const reps = Number(left.split('x')[0]);
    const repMin = Number(left.split('x')[1]);
    const pct = Number(right.split('-')[0] || right);
    const rec = Number(right.split('-')[1] || 0);
    return {reps, repMin, pct, rec};
  }
  function buildSession(){
    const sel = document.getElementById('preset').value;
    if(!sel){ alert('Choisis une s√©ance.'); return; }
    const preset = parsePreset(sel);
    const lap = parseFloat(document.getElementById('lap').value) || 253;
    const vma = parseFloat(document.getElementById('vma').value) || 12;
    const v_kmh = vma * (preset.pct/100);
    const v_mps = v_kmh * 1000 / 3600;
    const v_mpm = v_kmh * 1000 / 60;

    let rows = '';
    let totalDist = 0;
    for(let i=1;i<=preset.reps;i++){
      const dist = v_mpm * preset.repMin;
      const laps = dist / lap;
      const lapTime_s = lap / v_mps;
      totalDist += dist;
      rows += `<tr><td>${i}</td><td>${preset.repMin}'</td><td>${preset.pct}%</td><td>${Math.round(dist)} m</td><td>${round(laps,2)}</td><td>${toMMSS(lapTime_s)}</td></tr>`;
    }
    const totalLaps = totalDist / lap;
    const lapTime_s = lap / v_mps;

    const html = `
      <div><b>Entr√©es :</b> Tour ${lap} m ‚Ä¢ VMA ${vma} km/h ‚Ä¢ ${preset.reps} √ó ${preset.repMin}' @ ${preset.pct}% (r√©cup ${preset.rec||0}')
      <br><b>Temps au tour conseill√© :</b> ${toMMSS(lapTime_s)} (‚âà ${round(lapTime_s,1)} s)</div>
      <div style="margin-top:8px;overflow:auto">
        <table>
          <thead><tr><th>R√©p√©tition</th><th>Dur√©e</th><th>%VMA</th><th>Distance</th><th>Tours</th><th>Temps/tour</th></tr></thead>
          <tbody>${rows}</tbody>
          <tfoot><tr><th colspan="3">Total</th><th>${Math.round(totalDist)} m</th><th>${round(totalLaps,2)}</th><th>‚Äî</th></tr></tfoot>
        </table>
      </div>`;

    const out = document.getElementById('outS');
    out.hidden = false;
    out.innerHTML = html;
  }
  function applyToInputs(){
    const sel = document.getElementById('preset').value;
    if(!sel){ alert('Choisis une s√©ance.'); return; }
    const preset = parsePreset(sel);
    document.getElementById('pct').value = preset.pct;
    document.getElementById('dur').value = preset.repMin;
    calcFromVMA();
  }

  // S√©ance personnalis√©e
  function buildCustom(){
    const lap = parseFloat(document.getElementById('lap').value) || 253;
    const vma = parseFloat(document.getElementById('vma').value) || 12;
    const reps = parseFloat(document.getElementById('repCount').value);
    const repMin = parseFloat(document.getElementById('repMin').value);
    const pct = parseFloat(document.getElementById('pctP').value);
    const rec = parseFloat(document.getElementById('recP').value) || 0;
    if(!lap || !vma || !reps || !repMin || !pct){ alert('Compl√®te les champs de la s√©ance perso.'); return; }

    const v_kmh = vma * (pct/100);
    const v_mps = v_kmh * 1000 / 3600;
    const v_mpm = v_kmh * 1000 / 60;

    let rows = '';
    let totalDist = 0;
    for(let i=1;i<=reps;i++){
      const dist = v_mpm * repMin;
      const laps = dist / lap;
      const lapTime_s = lap / v_mps;
      totalDist += dist;
      rows += `<tr><td>${i}</td><td>${repMin}'</td><td>${pct}%</td><td>${Math.round(dist)} m</td><td>${round(laps,2)}</td><td>${toMMSS(lapTime_s)}</td></tr>`;
    }
    const totalLaps = totalDist / lap;
    const totalTimeMin = reps*repMin + rec*(reps-1);
    const lapTime_s = lap / v_mps;

    const html = `
      <div><b>Entr√©es :</b> Tour ${lap} m ‚Ä¢ VMA ${vma} km/h ‚Ä¢ ${reps} √ó ${repMin}' @ ${pct}% (r√©cup ${rec}')
      <br><b>Temps au tour conseill√© :</b> ${toMMSS(lapTime_s)} (‚âà ${round(lapTime_s,1)} s) ‚Ä¢ <b>Dur√©e totale estim√©e :</b> ${totalTimeMin}'</div>
      <div style="margin-top:8px;overflow:auto">
        <table>
          <thead><tr><th>R√©p√©tition</th><th>Dur√©e</th><th>%VMA</th><th>Distance</th><th>Tours</th><th>Temps/tour</th></tr></thead>
          <tbody>${rows}</tbody>
          <tfoot><tr><th colspan="3">Total</th><th>${Math.round(totalDist)} m</th><th>${round(totalLaps,2)}</th><th>‚Äî</th></tr></tfoot>
        </table>
      </div>`;

    const out = document.getElementById('outSP');
    out.hidden = false;
    out.innerHTML = html;
  }

  // Passages cumul√©s (A, B, S, SP)
  function buildPassages(kind){
    if(kind==='A'){
      const lap = parseFloat(document.getElementById('lap').value);
      const vma = parseFloat(document.getElementById('vma').value);
      const pct = parseFloat(document.getElementById('pct').value);
      const dur = parseFloat(document.getElementById('dur').value);
      if(!lap||!vma||!pct||!dur){ alert('Compl√®te les champs du bloc A.'); return; }
      const v_kmh = vma*(pct/100);
      const v_mps = v_kmh*1000/3600;
      const lapS = lap / v_mps;
      const totalS = dur*60;
      const laps = Math.floor(totalS / lapS);
      let rows='';
      for(let i=1;i<=laps;i++) rows += `<tr><td>${i}</td><td>${toMMSS(i*lapS)}</td></tr>`;
      const html = `<div><b>Passages cumul√©s</b> ‚Äî Tour ${lap} m ‚Ä¢ Temps/tour cible ${toMMSS(lapS)} ‚Ä¢ Dur√©e ${dur}'</div>
      <div style="overflow:auto;margin-top:6px"><table><thead><tr><th>Tour</th><th>Temps cumul√©</th></tr></thead><tbody>${rows}</tbody></table></div>`;
      const box = document.getElementById('passA'); box.hidden=false; box.innerHTML=html;
    }
    if(kind==='B'){
      const lap = parseFloat(document.getElementById('lap2').value);
      const lapTimeTxt = document.getElementById('lapTime').value.trim();
      const dur = parseFloat(document.getElementById('dur2').value);
      if(!lap||!lapTimeTxt||!dur){ alert('Indique distance, temps au tour et dur√©e.'); return; }
      const lapS = toSeconds(lapTimeTxt);
      if(!isFinite(lapS)){ alert('Temps au tour invalide (mm:ss).'); return; }
      const totalS = dur*60;
      const laps = Math.floor(totalS / lapS);
      let rows='';
      for(let i=1;i<=laps;i++) rows += `<tr><td>${i}</td><td>${toMMSS(i*lapS)}</td></tr>`;
      const html = `<div><b>Passages cumul√©s</b> ‚Äî Tour ${lap} m ‚Ä¢ Temps/tour ${toMMSS(lapS)} ‚Ä¢ Dur√©e ${dur}'</div>
      <div style="overflow:auto;margin-top:6px"><table><thead><tr><th>Tour</th><th>Temps cumul√©</th></tr></thead><tbody>${rows}</tbody></table></div>`;
      const box = document.getElementById('passB'); box.hidden=false; box.innerHTML=html;
    }
    if(kind==='S' || kind==='SP'){
      const isPreset = (kind==='S');
      const lap = parseFloat(document.getElementById('lap').value) || 253;
      const vma = parseFloat(document.getElementById('vma').value) || 12;
      let reps, repMin, pct, rec;
      if(isPreset){
        const code = document.getElementById('preset').value; if(!code){alert('Choisis une s√©ance.');return;}
        ({reps, repMin, pct, rec} = parsePreset(code));
      } else {
        reps = parseFloat(document.getElementById('repCount').value);
        repMin = parseFloat(document.getElementById('repMin').value);
        pct = parseFloat(document.getElementById('pctP').value);
        rec = parseFloat(document.getElementById('recP').value)||0;
      }
      if(!lap||!vma||!reps||!repMin||!pct){ alert('Compl√®te les champs de s√©ance.'); return; }
      const v_kmh = vma*(pct/100);
      const v_mps = v_kmh*1000/3600;
      const lapS = lap / v_mps;
      let sections='';
      for(let r=1;r<=reps;r++){
        const lapsThisRep = Math.floor((repMin*60)/lapS);
        let rows='';
        for(let i=1;i<=lapsThisRep;i++) rows += `<tr><td>${i}</td><td>${toMMSS(i*lapS)}</td></tr>`;
        sections += `<h4 style="margin:8px 0 4px">R√©p√©tition ${r} ‚Äî ${repMin}' @ ${pct}%</h4>
          <div style="overflow:auto"><table><thead><tr><th>Tour</th><th>Temps cumul√©</th></tr></thead><tbody>${rows}</tbody></table></div>`;
      }
      const html = `<div><b>Passages cumul√©s</b> ‚Äî Tour ${lap} m ‚Ä¢ Temps/tour cible ${toMMSS(lapS)} ‚Ä¢ R√©cup ${rec||0}'</div>${sections}`;
      const id = isPreset ? 'passS' : 'passSP';
      const box = document.getElementById(id); box.hidden=false; box.innerHTML=html;
    }
  }
</script>
</body>
</html>
